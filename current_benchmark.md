# AFTER NUM_WORKERS := 12 (from 4)

Before runtime=129.92
After runtime=150.55
Speedup = 0.86292

# AFTER TORCH COMPILE TRAINING_STEP

Speedup 2.9134/2.1273 = 1.36952

    |  Action                                           |  Mean duration (s)    |  Num calls            |  Total time (s)       |  Percentage %         |
    Before
    |  LightningModule]EfficientFSModule.optimizer_step |  0.23598              |  180                  |  42.476             |  23.896                |
    |  run_training_epoch                               |  2.9134               |  60                   |  174.8              |  98.339                |
    After
    |  [LightningModule]EfficientFSModule.optimizer_step|  0.18113              |  180                  |  32.603               |  25.095               |
    |  run_training_epoch                               |  2.1273               |  60                   |  127.64               |  98.243               |


    Removing weight norm...
    --------------- Options ---------------
    accelerator: cuda
    devices: 1
    precision: 16
    num_workers: 4
    max_epochs: 60
    warmup_epochs: 50
    preprocess_config: config/VCTK/preprocess.yaml
    weight_decay: 1e-05
    lr: 0.001
    batch_size: 128
    dropout: 0.0
    depth: 2
    block_depth: 3
    n_blocks: 3
    reduction: 1
    head: 2
    embed_dim: 128
    kernel_size: 5
    decoder_kernel_size: 5
    expansion: 2
    out_folder: base_english2
    resume_from_checkpoint: None
    to_torchscript: False
    hifigan_checkpoint: hifigan/LJ_V2/generator_v2
    synthesize: False
    infer_device: None
    checkpoint: checkpoints/tiny_english_drp0.1f.ckpt
    wav_path: wav_outputs
    wav_filename: efficient_speech
    checkpoints: checkpoints
    text: None
    verbose: True
    onnx: None
    onnx_insize: 128
    onnx_opset: 13
    jit: None
    benchmark: False
    ---------------------------------------

    Using 16bit native Automatic Mixed Precision (AMP)
    GPU available: True (cuda), used: True
    TPU available: False, using: 0 TPU cores
    IPU available: False, using: 0 IPUs
    HPU available: False, using: 0 HPUs
    Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
    ----------------------------------------------------------------------------------------------------
    distributed_backend=nccl
    All distributed processes registered. Starting with 1 processes
    ----------------------------------------------------------------------------------------------------

    LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

      | Name        | Type        | Params
    --------------------------------------------
    0 | phoneme2mel | Phoneme2Mel | 4.0 M 
    1 | hifigan     | Generator   | 925 K 
    --------------------------------------------
    4.0 M     Trainable params
    926 K     Non-trainable params
    4.9 M     Total params
    9.759     Total estimated model params size (MB)
    Epoch 0:   0%|                                                                                                                                                                                                                                                                         | 0/3 [00:00<?, ?it/s]Compiling training step
    Epoch 59: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:03<00:00,  1.21it/s, loss=10.1, v_num=27, mel=0.936, pitch=0.124, energy=0.0172, dur=0.203, lr=0.000]`Trainer.fit` stopped: `max_epochs=60` reached.                                                                                                                                                                                                                                                              
    Epoch 59: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:03<00:00,  1.21it/s, loss=10.1, v_num=27, mel=0.936, pitch=0.124, energy=0.0172, dur=0.203, lr=0.000]
    FIT Profiler Report

    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  Action                                                                                                                                                                                               |  Mean duration (s)    |  Num calls            |  Total time (s)       |  Percentage %         |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  Total                                                                                                                                                                                                |  -                    |  9084                 |  129.92               |  100 %                |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  run_training_epoch                                                                                                                                                                                   |  2.1273               |  60                   |  127.64               |  98.243               |
    |  [TrainingEpochLoop].train_dataloader_next                                                                                                                                                            |  0.45486              |  180                  |  81.875               |  63.02                |
    |  run_training_batch                                                                                                                                                                                   |  0.18148              |  180                  |  32.666               |  25.143               |
    |  [LightningModule]EfficientFSModule.optimizer_step                                                                                                                                                    |  0.18113              |  180                  |  32.603               |  25.095               |
    |  [Strategy]DDPStrategy.training_step                                                                                                                                                                  |  0.12037              |  180                  |  21.667               |  16.678               |
    |  [Strategy]DDPStrategy.backward                                                                                                                                                                       |  0.056641             |  180                  |  10.195               |  7.8474               |
    |  [EvaluationEpochLoop].val_dataloader_idx_0_next                                                                                                                                                      |  0.75206              |  6                    |  4.5124               |  3.4732               |
    |  [Strategy]DDPStrategy.validation_step                                                                                                                                                                |  0.56558              |  7                    |  3.959                |  3.0473               |
    |  [EvaluationEpochLoop].None_dataloader_idx_0_next                                                                                                                                                     |  0.82898              |  1                    |  0.82898              |  0.63807              |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_end            |  0.10601              |  7                    |  0.7421               |  0.5712               |
    |  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                         |  0.0027363            |  60                   |  0.16418              |  0.12637              |
    |  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                                                         |  0.00071577           |  180                  |  0.12884              |  0.099169             |
    |  [Strategy]DDPStrategy.batch_to_device                                                                                                                                                                |  0.0006549            |  187                  |  0.12247              |  0.094264             |
    |  [LightningModule]EfficientFSModule.training_epoch_end                                                                                                                                                |  0.0017903            |  60                   |  0.10742              |  0.082682             |
    |  [LightningModule]EfficientFSModule.transfer_batch_to_device                                                                                                                                          |  0.00056815           |  187                  |  0.10624              |  0.081777             |
    |  [LightningModule]EfficientFSModule.optimizer_zero_grad                                                                                                                                               |  0.00044948           |  180                  |  0.080906             |  0.062274             |
    |  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                       |  0.00031327           |  60                   |  0.018796             |  0.014468             |
    |  [LightningModule]EfficientFSModule.lr_scheduler_step                                                                                                                                                 |  0.00015556           |  60                   |  0.0093334            |  0.007184             |
    |  [LightningDataModule]LJSpeechDataModule.setup                                                                                                                                                        |  0.0088754            |  1                    |  0.0088754            |  0.0068315            |
    |  [LightningDataModule]LJSpeechDataModule.prepare_data                                                                                                                                                 |  0.0082553            |  1                    |  0.0082553            |  0.0063542            |
    |  [LightningModule]EfficientFSModule.configure_gradient_clipping                                                                                                                                       |  4.3619e-05           |  180                  |  0.0078514            |  0.0060433            |
    |  [LightningModule]EfficientFSModule.on_validation_model_eval                                                                                                                                          |  0.0011111            |  7                    |  0.0077774            |  0.0059864            |
    |  [LightningModule]EfficientFSModule.on_validation_model_train                                                                                                                                         |  0.00088747           |  7                    |  0.0062123            |  0.0047817            |
    |  [Callback]ModelSummary.on_fit_start                                                                                                                                                                  |  0.0061495            |  1                    |  0.0061495            |  0.0047333            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_end           |  3.1649e-05           |  180                  |  0.0056968            |  0.0043849            |
    |  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                          |  0.00074533           |  7                    |  0.0052173            |  0.0040158            |
    |  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                  |  0.00063335           |  7                    |  0.0044334            |  0.0034125            |
    |  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                    |  0.00045748           |  7                    |  0.0032024            |  0.0024649            |
    |  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                        |  0.00032791           |  7                    |  0.0022954            |  0.0017668            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_end           |  2.3096e-05           |  60                   |  0.0013857            |  0.0010666            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                         |  0.0010804            |  1                    |  0.0010804            |  0.0008316            |
    |  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                      |  0.00085235           |  1                    |  0.00085235           |  0.00065606           |
    |  [LightningModule]EfficientFSModule.on_before_batch_transfer                                                                                                                                          |  4.492e-06            |  187                  |  0.00084001           |  0.00064656           |
    |  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                        |  4.6213e-06           |  180                  |  0.00083184           |  0.00064027           |
    |  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                          |  4.4951e-06           |  180                  |  0.00080913           |  0.00062279           |
    |  [LightningModule]EfficientFSModule.on_train_batch_start                                                                                                                                              |  3.4597e-06           |  180                  |  0.00062275           |  0.00047934           |
    |  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                   |  2.6706e-06           |  180                  |  0.00048071           |  0.00037001           |
    |  [LightningModule]EfficientFSModule.configure_optimizers                                                                                                                                              |  0.00047671           |  1                    |  0.00047671           |  0.00036693           |
    |  [Callback]ModelSummary.on_train_batch_end                                                                                                                                                            |  2.6155e-06           |  180                  |  0.00047079           |  0.00036237           |
    |  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                                                       |  2.5347e-06           |  180                  |  0.00045625           |  0.00035118           |
    |  [LightningModule]EfficientFSModule.on_after_batch_transfer                                                                                                                                           |  2.0687e-06           |  187                  |  0.00038684           |  0.00029776           |
    |  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                         |  1.936e-06            |  180                  |  0.00034847           |  0.00026822           |
    |  [LightningModule]EfficientFSModule.on_before_backward                                                                                                                                                |  1.8706e-06           |  180                  |  0.0003367            |  0.00025916           |
    |  [Strategy]DDPStrategy.on_train_batch_start                                                                                                                                                           |  1.8184e-06           |  180                  |  0.00032731           |  0.00025194           |
    |  [LightningModule]EfficientFSModule.training_step_end                                                                                                                                                 |  1.7056e-06           |  180                  |  0.00030702           |  0.00023631           |
    |  [LightningModule]EfficientFSModule.on_after_backward                                                                                                                                                 |  1.3603e-06           |  180                  |  0.00024486           |  0.00018847           |
    |  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                         |  3.9869e-06           |  60                   |  0.00023921           |  0.00018412           |
    |  [Callback]ModelSummary.on_after_backward                                                                                                                                                             |  1.2976e-06           |  180                  |  0.00023356           |  0.00017978           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_after_backward            |  1.1775e-06           |  180                  |  0.00021194           |  0.00016314           |
    |  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                      |  1.0613e-06           |  180                  |  0.00019104           |  0.00014705           |
    |  [Callback]GradientAccumulationScheduler.on_train_batch_end                                                                                                                                           |  1.0256e-06           |  180                  |  0.00018461           |  0.0001421            |
    |  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                               |  0.0001815            |  1                    |  0.0001815            |  0.0001397            |
    |  [LightningModule]EfficientFSModule.on_before_zero_grad                                                                                                                                               |  9.9589e-07           |  180                  |  0.00017926           |  0.00013798           |
    |  [LightningModule]EfficientFSModule.on_train_batch_end                                                                                                                                                |  9.916e-07            |  180                  |  0.00017849           |  0.00013738           |
    |  [Strategy]DDPStrategy.training_step_end                                                                                                                                                              |  9.5699e-07           |  180                  |  0.00017226           |  0.00013259           |
    |  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                           |  9.5258e-07           |  180                  |  0.00017146           |  0.00013198           |
    |  [Callback]ModelSummary.on_train_batch_start                                                                                                                                                          |  9.4935e-07           |  180                  |  0.00017088           |  0.00013153           |
    |  [Callback]ModelSummary.on_before_backward                                                                                                                                                            |  9.4417e-07           |  180                  |  0.00016995           |  0.00013081           |
    |  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                            |  9.0786e-07           |  180                  |  0.00016341           |  0.00012578           |
    |  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                            |  2.712e-06            |  60                   |  0.00016272           |  0.00012525           |
    |  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                             |  0.0001627            |  1                    |  0.0001627            |  0.00012524           |
    |  [LightningModule]EfficientFSModule.on_before_optimizer_step                                                                                                                                          |  8.8266e-07           |  180                  |  0.00015888           |  0.00012229           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_start         |  8.3409e-07           |  180                  |  0.00015014           |  0.00011556           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_zero_grad          |  8.2914e-07           |  180                  |  0.00014924           |  0.00011488           |
    |  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                     |  8.2261e-07           |  180                  |  0.00014807           |  0.00011397           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_optimizer_step     |  8.0362e-07           |  180                  |  0.00014465           |  0.00011134           |
    |  [Callback]GradientAccumulationScheduler.on_train_batch_start                                                                                                                                         |  7.5086e-07           |  180                  |  0.00013515           |  0.00010403           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_backward           |  7.4872e-07           |  180                  |  0.00013477           |  0.00010373           |
    |  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                          |  2.2379e-06           |  60                   |  0.00013427           |  0.00010335           |
    |  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                          |  7.2993e-07           |  180                  |  0.00013139           |  0.00010113           |
    |  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                           |  7.2439e-07           |  180                  |  0.00013039           |  0.00010036           |
    |  [LightningModule]EfficientFSModule.on_train_epoch_end                                                                                                                                                |  1.0874e-06           |  60                   |  6.5244e-05           |  5.0219e-05           |
    |  [LightningModule]EfficientFSModule.on_train_epoch_start                                                                                                                                              |  1.0289e-06           |  60                   |  6.1734e-05           |  4.7517e-05           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_start         |  9.3385e-07           |  60                   |  5.6031e-05           |  4.3128e-05           |
    |  [Callback]ModelSummary.on_validation_end                                                                                                                                                             |  7.6356e-06           |  7                    |  5.3449e-05           |  4.114e-05            |
    |  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                           |  8.357e-07            |  60                   |  5.0142e-05           |  3.8595e-05           |
    |  [LightningModule]EfficientFSModule.on_validation_end                                                                                                                                                 |  6.0399e-06           |  7                    |  4.2279e-05           |  3.2543e-05           |
    |  [LightningModule]EfficientFSModule.on_validation_batch_start                                                                                                                                         |  5.9653e-06           |  7                    |  4.1757e-05           |  3.2141e-05           |
    |  [LightningDataModule]LJSpeechDataModule.state_dict                                                                                                                                                   |  6.3002e-06           |  6                    |  3.7801e-05           |  2.9096e-05           |
    |  [Strategy]DDPStrategy.on_validation_end                                                                                                                                                              |  3.7699e-06           |  7                    |  2.6389e-05           |  2.0312e-05           |
    |  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                       |  3.661e-06            |  7                    |  2.5627e-05           |  1.9725e-05           |
    |  [Callback]ModelSummary.on_validation_start                                                                                                                                                           |  2.6349e-06           |  7                    |  1.8444e-05           |  1.4197e-05           |
    |  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                     |  2.4576e-06           |  7                    |  1.7203e-05           |  1.3241e-05           |
    |  [LightningModule]EfficientFSModule.validation_step_end                                                                                                                                               |  2.1984e-06           |  7                    |  1.5389e-05           |  1.1845e-05           |
    |  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                                                         |  2.2093e-06           |  6                    |  1.3256e-05           |  1.0203e-05           |
    |  [LightningModule]EfficientFSModule.validation_epoch_end                                                                                                                                              |  1.4441e-06           |  7                    |  1.0109e-05           |  7.781e-06            |
    |  [Strategy]DDPStrategy.on_validation_start                                                                                                                                                            |  1.4427e-06           |  7                    |  1.0099e-05           |  7.7733e-06           |
    |  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                  |  1.4284e-06           |  7                    |  9.999e-06            |  7.6964e-06           |
    |  [LightningModule]EfficientFSModule.on_validation_start                                                                                                                                               |  1.4169e-06           |  7                    |  9.918e-06            |  7.634e-06            |
    |  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                    |  1.3953e-06           |  7                    |  9.767e-06            |  7.5178e-06           |
    |  [Callback]TQDMProgressBar.setup                                                                                                                                                                      |  9.318e-06            |  1                    |  9.318e-06            |  7.1722e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_start    |  1.3267e-06           |  7                    |  9.287e-06            |  7.1483e-06           |
    |  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                    |  1.2026e-06           |  7                    |  8.418e-06            |  6.4794e-06           |
    |  [LightningModule]EfficientFSModule.on_validation_batch_end                                                                                                                                           |  1.1279e-06           |  7                    |  7.895e-06            |  6.0769e-06           |
    |  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                       |  1.0491e-06           |  7                    |  7.344e-06            |  5.6528e-06           |
    |  [Strategy]DDPStrategy.validation_step_end                                                                                                                                                            |  1.0421e-06           |  7                    |  7.295e-06            |  5.6151e-06           |
    |  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                      |  9.1614e-07           |  7                    |  6.413e-06            |  4.9362e-06           |
    |  [LightningModule]EfficientFSModule.on_validation_epoch_start                                                                                                                                         |  8.8571e-07           |  7                    |  6.2e-06              |  4.7722e-06           |
    |  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                            |  8.8314e-07           |  7                    |  6.182e-06            |  4.7584e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_start               |  6.071e-06            |  1                    |  6.071e-06            |  4.6729e-06           |
    |  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                          |  8.6014e-07           |  7                    |  6.021e-06            |  4.6344e-06           |
    |  [LightningModule]EfficientFSModule.on_validation_epoch_end                                                                                                                                           |  8.2871e-07           |  7                    |  5.801e-06            |  4.4651e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_start          |  8.2286e-07           |  7                    |  5.76e-06             |  4.4335e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_end      |  8.0714e-07           |  7                    |  5.65e-06             |  4.3489e-06           |
    |  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                     |  7.5129e-07           |  7                    |  5.259e-06            |  4.0479e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_start    |  7.0314e-07           |  7                    |  4.922e-06            |  3.7885e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_end      |  6.7829e-07           |  7                    |  4.748e-06            |  3.6546e-06           |
    |  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                    |  6.7557e-07           |  7                    |  4.729e-06            |  3.64e-06             |
    |  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                      |  6.6814e-07           |  7                    |  4.677e-06            |  3.5999e-06           |
    |  [Callback]ModelSummary.on_save_checkpoint                                                                                                                                                            |  7.6633e-07           |  6                    |  4.598e-06            |  3.5391e-06           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_save_checkpoint           |  7.5467e-07           |  6                    |  4.528e-06            |  3.4853e-06           |
    |  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                           |  7.38e-07             |  6                    |  4.428e-06            |  3.4083e-06           |
    |  [LightningModule]EfficientFSModule.setup                                                                                                                                                             |  4.037e-06            |  1                    |  4.037e-06            |  3.1073e-06           |
    |  [LightningModule]EfficientFSModule.on_save_checkpoint                                                                                                                                                |  6.21e-07             |  6                    |  3.726e-06            |  2.8679e-06           |
    |  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                        |  3.666e-06            |  1                    |  3.666e-06            |  2.8218e-06           |
    |  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                 |  3.567e-06            |  1                    |  3.567e-06            |  2.7456e-06           |
    |  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                               |  3.056e-06            |  1                    |  3.056e-06            |  2.3522e-06           |
    |  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                 |  2.765e-06            |  1                    |  2.765e-06            |  2.1283e-06           |
    |  [LightningModule]EfficientFSModule.configure_callbacks                                                                                                                                               |  2.605e-06            |  1                    |  2.605e-06            |  2.0051e-06           |
    |  [Callback]ModelSummary.on_train_end                                                                                                                                                                  |  2.535e-06            |  1                    |  2.535e-06            |  1.9512e-06           |
    |  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                         |  2.033e-06            |  1                    |  2.033e-06            |  1.5648e-06           |
    |  [Callback]ModelSummary.on_train_start                                                                                                                                                                |  1.824e-06            |  1                    |  1.824e-06            |  1.404e-06            |
    |  [Callback]TQDMProgressBar.teardown                                                                                                                                                                   |  1.563e-06            |  1                    |  1.563e-06            |  1.2031e-06           |
    |  [LightningDataModule]LJSpeechDataModule.teardown                                                                                                                                                     |  1.553e-06            |  1                    |  1.553e-06            |  1.1954e-06           |
    |  [Callback]ModelSummary.setup                                                                                                                                                                         |  1.543e-06            |  1                    |  1.543e-06            |  1.1877e-06           |
    |  [LightningModule]EfficientFSModule.configure_sharded_model                                                                                                                                           |  1.423e-06            |  1                    |  1.423e-06            |  1.0953e-06           |
    |  [LightningModule]EfficientFSModule.prepare_data                                                                                                                                                      |  1.402e-06            |  1                    |  1.402e-06            |  1.0791e-06           |
    |  [LightningModule]EfficientFSModule.on_fit_end                                                                                                                                                        |  1.333e-06            |  1                    |  1.333e-06            |  1.026e-06            |
    |  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                           |  1.222e-06            |  1                    |  1.222e-06            |  9.4059e-07           |
    |  [LightningModule]EfficientFSModule.on_fit_start                                                                                                                                                      |  1.082e-06            |  1                    |  1.082e-06            |  8.3283e-07           |
    |  [Strategy]DDPStrategy.on_train_start                                                                                                                                                                 |  1.032e-06            |  1                    |  1.032e-06            |  7.9434e-07           |
    |  [LightningModule]EfficientFSModule.on_train_start                                                                                                                                                    |  1.001e-06            |  1                    |  1.001e-06            |  7.7048e-07           |
    |  [Callback]ModelSummary.on_fit_end                                                                                                                                                                    |  9.52e-07             |  1                    |  9.52e-07             |  7.3277e-07           |
    |  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                               |  9.32e-07             |  1                    |  9.32e-07             |  7.1737e-07           |
    |  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                        |  9.02e-07             |  1                    |  9.02e-07             |  6.9428e-07           |
    |  [LightningModule]EfficientFSModule.on_train_end                                                                                                                                                      |  8.91e-07             |  1                    |  8.91e-07             |  6.8581e-07           |
    |  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                 |  8.71e-07             |  1                    |  8.71e-07             |  6.7042e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_start                 |  8.62e-07             |  1                    |  8.62e-07             |  6.6349e-07           |
    |  [Callback]ModelSummary.teardown                                                                                                                                                                      |  8.51e-07             |  1                    |  8.51e-07             |  6.5503e-07           |
    |  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                        |  8.01e-07             |  1                    |  8.01e-07             |  6.1654e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_end                 |  7.91e-07             |  1                    |  7.91e-07             |  6.0884e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.teardown                     |  7.91e-07             |  1                    |  7.91e-07             |  6.0884e-07           |
    |  [Strategy]DDPStrategy.on_train_end                                                                                                                                                                   |  7.82e-07             |  1                    |  7.82e-07             |  6.0192e-07           |
    |  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                     |  7.81e-07             |  1                    |  7.81e-07             |  6.0115e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_end                   |  7.61e-07             |  1                    |  7.61e-07             |  5.8575e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_start        |  7.42e-07             |  1                    |  7.42e-07             |  5.7113e-07           |
    |  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                   |  6.92e-07             |  1                    |  6.92e-07             |  5.3264e-07           |
    |  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                          |  6.91e-07             |  1                    |  6.91e-07             |  5.3187e-07           |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_end          |  6.51e-07             |  1                    |  6.51e-07             |  5.0108e-07           |
    |  [LightningModule]EfficientFSModule.teardown                                                                                                                                                          |  5.51e-07             |  1                    |  5.51e-07             |  4.2411e-07           |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



# BASELINE

    Using config:  /mnt/f/repos/efficientspeech/hifigan/LJ_V2/config.json
    Using hifigan checkpoint:  hifigan/LJ_V2/generator_v2
    Removing weight norm...
    --------------- Options ---------------
    accelerator: cuda
    devices: 1
    precision: 16
    num_workers: 4
    max_epochs: 60
    warmup_epochs: 50
    preprocess_config: config/VCTK/preprocess.yaml
    weight_decay: 1e-05
    lr: 0.001
    batch_size: 128
    dropout: 0.0
    depth: 2
    block_depth: 3
    n_blocks: 3
    reduction: 1
    head: 2
    embed_dim: 128
    kernel_size: 5
    decoder_kernel_size: 5
    expansion: 2
    out_folder: base_english2
    resume_from_checkpoint: None
    to_torchscript: False
    hifigan_checkpoint: hifigan/LJ_V2/generator_v2
    synthesize: False
    infer_device: None
    checkpoint: checkpoints/tiny_english_drp0.1f.ckpt
    wav_path: wav_outputs
    wav_filename: efficient_speech
    checkpoints: checkpoints
    text: None
    verbose: True
    onnx: None
    onnx_insize: 128
    onnx_opset: 13
    jit: None
    benchmark: False
    ---------------------------------------

    Using 16bit native Automatic Mixed Precision (AMP)
    GPU available: True (cuda), used: True
    TPU available: False, using: 0 TPU cores
    IPU available: False, using: 0 IPUs
    HPU available: False, using: 0 HPUs
    Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
    ----------------------------------------------------------------------------------------------------
    distributed_backend=nccl
    All distributed processes registered. Starting with 1 processes
    ----------------------------------------------------------------------------------------------------

    LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

      | Name        | Type        | Params
    --------------------------------------------
    0 | phoneme2mel | Phoneme2Mel | 4.0 M 
    1 | hifigan     | Generator   | 925 K 
    --------------------------------------------
    4.0 M     Trainable params
    926 K     Non-trainable params
    4.9 M     Total params
    9.759     Total estimated model params size (MB)
    Epoch 59: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:04<00:00,  1.11s/it, loss=10.4, v_num=24, mel=0.963, pitch=0.108, energy=0.021, dur=0.203, lr=0.000]`Trainer.fit` stopped: `max_epochs=60` reached.                                                                                                                                                                                                                                
    Epoch 59: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:04<00:00,  1.11s/it, loss=10.4, v_num=24, mel=0.963, pitch=0.108, energy=0.021, dur=0.203, lr=0.000]
    FIT Profiler Report

    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  Action                                                                                                                                                                                               |  Mean duration (s)    |  Num calls            |  Total time (s)     |  Percentage %          |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  Total                                                                                                                                                                                                |  -                    |  9084                 |  177.76             |  100 %                 |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |  run_training_epoch                                                                                                                                                                                   |  2.9134               |  60                   |  174.8              |  98.339                |
    |  [TrainingEpochLoop].train_dataloader_next                                                                                                                                                            |  0.6429               |  180                  |  115.72             |  65.102                |
    |  run_training_batch                                                                                                                                                                                   |  0.23635              |  180                  |  42.543             |  23.933                |
    |  [LightningModule]EfficientFSModule.optimizer_step                                                                                                                                                    |  0.23598              |  180                  |  42.476             |  23.896                |
    |  [Strategy]DDPStrategy.training_step                                                                                                                                                                  |  0.15197              |  180                  |  27.355             |  15.389                |
    |  [Strategy]DDPStrategy.backward                                                                                                                                                                       |  0.079614             |  180                  |  14.331             |  8.062                 |
    |  [EvaluationEpochLoop].val_dataloader_idx_0_next                                                                                                                                                      |  1.1116               |  6                    |  6.6695             |  3.7521                |
    |  [Strategy]DDPStrategy.validation_step                                                                                                                                                                |  0.69264              |  7                    |  4.8485             |  2.7276                |
    |  [EvaluationEpochLoop].None_dataloader_idx_0_next                                                                                                                                                     |  1.1203               |  1                    |  1.1203             |  0.63027               |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_end            |  0.12556              |  7                    |  0.87889            |  0.49444               |
    |  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                         |  0.0027667            |  60                   |  0.166              |  0.093388              |
    |  [Callback]TQDMProgressBar.on_train_batch_end                                                                                                                                                         |  0.00073842           |  180                  |  0.13292            |  0.074775              |
    |  [Strategy]DDPStrategy.batch_to_device                                                                                                                                                                |  0.00066774           |  187                  |  0.12487            |  0.070247              |
    |  [LightningModule]EfficientFSModule.training_epoch_end                                                                                                                                                |  0.0018275            |  60                   |  0.10965            |  0.061685              |
    |  [LightningModule]EfficientFSModule.transfer_batch_to_device                                                                                                                                          |  0.00057485           |  187                  |  0.1075             |  0.060475              |
    |  [LightningModule]EfficientFSModule.optimizer_zero_grad                                                                                                                                               |  0.00047243           |  180                  |  0.085038           |  0.04784               |
    |  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                       |  0.00030171           |  60                   |  0.018103           |  0.010184              |
    |  [LightningDataModule]LJSpeechDataModule.prepare_data                                                                                                                                                 |  0.014297             |  1                    |  0.014297           |  0.0080431             |
    |  [LightningDataModule]LJSpeechDataModule.setup                                                                                                                                                        |  0.0089184            |  1                    |  0.0089184          |  0.0050172             |
    |  [LightningModule]EfficientFSModule.configure_gradient_clipping                                                                                                                                       |  4.3215e-05           |  180                  |  0.0077786          |  0.004376              |
    |  [LightningModule]EfficientFSModule.on_validation_model_eval                                                                                                                                          |  0.0010689            |  7                    |  0.007482           |  0.0042092             |
    |  [LightningModule]EfficientFSModule.on_validation_model_train                                                                                                                                         |  0.00092602           |  7                    |  0.0064821          |  0.0036467             |
    |  [Callback]ModelSummary.on_fit_start                                                                                                                                                                  |  0.0060757            |  1                    |  0.0060757          |  0.003418              |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_end           |  2.9661e-05           |  180                  |  0.0053389          |  0.0030035             |
    |  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                          |  0.00073785           |  7                    |  0.0051649          |  0.0029056             |
    |  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                  |  0.00065925           |  7                    |  0.0046148          |  0.0025961             |
    |  [LightningModule]EfficientFSModule.lr_scheduler_step                                                                                                                                                 |  6.764e-05            |  60                   |  0.0040584          |  0.0022832             |
    |  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                    |  0.00045703           |  7                    |  0.0031992          |  0.0017998             |
    |  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                        |  0.00030796           |  7                    |  0.0021557          |  0.0012127             |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_end           |  3.0748e-05           |  60                   |  0.0018449          |  0.0010379             |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                         |  0.0012723            |  1                    |  0.0012723          |  0.00071576            |
    |  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                          |  5.1761e-06           |  180                  |  0.0009317          |  0.00052415            |
    |  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                      |  0.00080152           |  1                    |  0.00080152         |  0.00045091            |
    |  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                   |  4.09e-06             |  180                  |  0.00073621         |  0.00041417            |
    |  [LightningModule]EfficientFSModule.on_before_batch_transfer                                                                                                                                          |  3.8734e-06           |  187                  |  0.00072432         |  0.00040748            |
    |  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                        |  3.9513e-06           |  180                  |  0.00071124         |  0.00040012            |
    |  [LightningModule]EfficientFSModule.on_after_backward                                                                                                                                                 |  3.1859e-06           |  180                  |  0.00057345         |  0.00032261            |
    |  [Callback]TQDMProgressBar.on_train_batch_start                                                                                                                                                       |  3.0523e-06           |  180                  |  0.00054942         |  0.00030909            |
    |  [LightningModule]EfficientFSModule.on_train_batch_start                                                                                                                                              |  2.942e-06            |  180                  |  0.00052957         |  0.00029792            |
    |  [Callback]ModelSummary.on_train_batch_end                                                                                                                                                            |  2.8896e-06           |  180                  |  0.00052013         |  0.00029261            |
    |  [LightningModule]EfficientFSModule.on_after_batch_transfer                                                                                                                                           |  2.549e-06            |  187                  |  0.00047667         |  0.00026816            |
    |  [LightningModule]EfficientFSModule.configure_optimizers                                                                                                                                              |  0.00046303           |  1                    |  0.00046303         |  0.00026049            |
    |  [LightningModule]EfficientFSModule.on_before_optimizer_step                                                                                                                                          |  2.005e-06            |  180                  |  0.0003609          |  0.00020303            |
    |  [LightningModule]EfficientFSModule.training_step_end                                                                                                                                                 |  1.927e-06            |  180                  |  0.00034686         |  0.00019513            |
    |  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                         |  1.8911e-06           |  180                  |  0.00034039         |  0.00019149            |
    |  [Strategy]DDPStrategy.on_train_batch_start                                                                                                                                                           |  1.878e-06            |  180                  |  0.00033804         |  0.00019017            |
    |  [Callback]ModelSummary.on_after_backward                                                                                                                                                             |  1.263e-06            |  180                  |  0.00022733         |  0.00012789            |
    |  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                            |  3.3328e-06           |  60                   |  0.00019997         |  0.0001125             |
    |  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                         |  3.3098e-06           |  60                   |  0.00019859         |  0.00011172            |
    |  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                               |  0.00019794           |  1                    |  0.00019794         |  0.00011136            |
    |  [LightningModule]EfficientFSModule.on_before_zero_grad                                                                                                                                               |  1.078e-06            |  180                  |  0.00019403         |  0.00010916            |
    |  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                      |  1.0615e-06           |  180                  |  0.00019107         |  0.00010749            |
    |  [LightningModule]EfficientFSModule.on_train_batch_end                                                                                                                                                |  1.0472e-06           |  180                  |  0.0001885          |  0.00010604            |
    |  [Callback]GradientAccumulationScheduler.on_train_batch_end                                                                                                                                           |  1.0136e-06           |  180                  |  0.00018244         |  0.00010264            |
    |  [Callback]ModelSummary.on_train_batch_start                                                                                                                                                          |  9.9759e-07           |  180                  |  0.00017957         |  0.00010102            |
    |  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                           |  9.7549e-07           |  180                  |  0.00017559         |  9.8781e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_zero_grad          |  9.5233e-07           |  180                  |  0.00017142         |  9.6436e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_batch_start         |  9.3258e-07           |  180                  |  0.00016786         |  9.4435e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_after_backward            |  9.1256e-07           |  180                  |  0.00016426         |  9.2408e-05            |
    |  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                            |  8.9146e-07           |  180                  |  0.00016046         |  9.0271e-05            |
    |  [Strategy]DDPStrategy.training_step_end                                                                                                                                                              |  8.706e-07            |  180                  |  0.00015671         |  8.8159e-05            |
    |  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                             |  0.0001563            |  1                    |  0.0001563          |  8.7932e-05            |
    |  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                     |  8.3496e-07           |  180                  |  0.00015029         |  8.455e-05             |
    |  [Callback]ModelSummary.on_before_backward                                                                                                                                                            |  8.3362e-07           |  180                  |  0.00015005         |  8.4415e-05            |
    |  [LightningModule]EfficientFSModule.on_before_backward                                                                                                                                                |  8.2551e-07           |  180                  |  0.00014859         |  8.3593e-05            |
    |  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                          |  2.3861e-06           |  60                   |  0.00014317         |  8.0541e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_optimizer_step     |  7.8693e-07           |  180                  |  0.00014165         |  7.9687e-05            |
    |  [Callback]GradientAccumulationScheduler.on_train_batch_start                                                                                                                                         |  7.8121e-07           |  180                  |  0.00014062         |  7.9108e-05            |
    |  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                          |  7.6064e-07           |  180                  |  0.00013691         |  7.7024e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_before_backward           |  7.2986e-07           |  180                  |  0.00013138         |  7.3908e-05            |
    |  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                           |  6.7374e-07           |  180                  |  0.00012127         |  6.8225e-05            |
    |  [LightningModule]EfficientFSModule.on_train_epoch_end                                                                                                                                                |  1.0976e-06           |  60                   |  6.5853e-05         |  3.7047e-05            |
    |  [LightningModule]EfficientFSModule.on_train_epoch_start                                                                                                                                              |  1.0356e-06           |  60                   |  6.2135e-05         |  3.4955e-05            |
    |  [LightningDataModule]LJSpeechDataModule.state_dict                                                                                                                                                   |  9.5847e-06           |  6                    |  5.7508e-05         |  3.2352e-05            |
    |  [Callback]ModelSummary.on_validation_end                                                                                                                                                             |  7.7431e-06           |  7                    |  5.4202e-05         |  3.0492e-05            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_epoch_start         |  8.532e-07            |  60                   |  5.1192e-05         |  2.8799e-05            |
    |  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                           |  8.3777e-07           |  60                   |  5.0266e-05         |  2.8278e-05            |
    |  [LightningModule]EfficientFSModule.on_validation_batch_end                                                                                                                                           |  6.4549e-06           |  7                    |  4.5184e-05         |  2.5419e-05            |
    |  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                                                         |  5.4218e-06           |  6                    |  3.2531e-05         |  1.8301e-05            |
    |  [Strategy]DDPStrategy.on_validation_end                                                                                                                                                              |  4.4999e-06           |  7                    |  3.1499e-05         |  1.772e-05             |
    |  [LightningModule]EfficientFSModule.on_validation_batch_start                                                                                                                                         |  3.8441e-06           |  7                    |  2.6909e-05         |  1.5138e-05            |
    |  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                       |  3.7627e-06           |  7                    |  2.6339e-05         |  1.4818e-05            |
    |  [Callback]ModelSummary.on_validation_start                                                                                                                                                           |  2.5377e-06           |  7                    |  1.7764e-05         |  9.9935e-06            |
    |  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                     |  2.5019e-06           |  7                    |  1.7513e-05         |  9.8523e-06            |
    |  [LightningModule]EfficientFSModule.on_validation_end                                                                                                                                                 |  2.3944e-06           |  7                    |  1.6761e-05         |  9.4293e-06            |
    |  [LightningModule]EfficientFSModule.validation_step_end                                                                                                                                               |  2.2741e-06           |  7                    |  1.5919e-05         |  8.9556e-06            |
    |  [Callback]TQDMProgressBar.setup                                                                                                                                                                      |  1.5729e-05           |  1                    |  1.5729e-05         |  8.8487e-06            |
    |  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                    |  1.5901e-06           |  7                    |  1.1131e-05         |  6.262e-06             |
    |  [LightningModule]EfficientFSModule.validation_epoch_end                                                                                                                                              |  1.4857e-06           |  7                    |  1.04e-05           |  5.8507e-06            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_start    |  1.2996e-06           |  7                    |  9.097e-06          |  5.1177e-06            |
    |  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                  |  1.2751e-06           |  7                    |  8.926e-06          |  5.0215e-06            |
    |  [LightningModule]EfficientFSModule.on_validation_epoch_end                                                                                                                                           |  1.224e-06            |  7                    |  8.568e-06          |  4.8201e-06            |
    |  [Strategy]DDPStrategy.on_validation_start                                                                                                                                                            |  1.1964e-06           |  7                    |  8.375e-06          |  4.7115e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                    |  1.115e-06            |  7                    |  7.805e-06          |  4.3909e-06            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_batch_end      |  1.0993e-06           |  7                    |  7.695e-06          |  4.329e-06             |
    |  [Strategy]DDPStrategy.validation_step_end                                                                                                                                                            |  1.0663e-06           |  7                    |  7.464e-06          |  4.199e-06             |
    |  [LightningModule]EfficientFSModule.on_validation_start                                                                                                                                               |  1.0204e-06           |  7                    |  7.143e-06          |  4.0184e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                      |  1.0117e-06           |  7                    |  7.082e-06          |  3.9841e-06            |
    |  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                       |  9.2057e-07           |  7                    |  6.444e-06          |  3.6252e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                            |  9.2029e-07           |  7                    |  6.442e-06          |  3.6241e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                          |  8.1857e-07           |  7                    |  5.73e-06           |  3.2235e-06            |
    |  [LightningModule]EfficientFSModule.on_validation_epoch_start                                                                                                                                         |  7.7714e-07           |  7                    |  5.44e-06           |  3.0604e-06            |
    |  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                           |  9.0517e-07           |  6                    |  5.431e-06          |  3.0553e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                      |  7.6714e-07           |  7                    |  5.37e-06           |  3.021e-06             |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_end      |  7.6571e-07           |  7                    |  5.36e-06           |  3.0154e-06            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_start          |  7.2843e-07           |  7                    |  5.099e-06          |  2.8685e-06            |
    |  [Callback]ModelSummary.on_save_checkpoint                                                                                                                                                            |  8.185e-07            |  6                    |  4.911e-06          |  2.7628e-06            |
    |  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                     |  6.4829e-07           |  7                    |  4.538e-06          |  2.5529e-06            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_validation_epoch_start    |  6.4829e-07           |  7                    |  4.538e-06          |  2.5529e-06            |
    |  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                 |  4.528e-06            |  1                    |  4.528e-06          |  2.5473e-06            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_save_checkpoint           |  7.395e-07            |  6                    |  4.437e-06          |  2.4961e-06            |
    |  [LightningModule]EfficientFSModule.on_save_checkpoint                                                                                                                                                |  7.2617e-07           |  6                    |  4.357e-06          |  2.4511e-06            |
    |  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                    |  6.17e-07             |  7                    |  4.319e-06          |  2.4297e-06            |
    |  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                               |  3.115e-06            |  1                    |  3.115e-06          |  1.7524e-06            |
    |  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                        |  3.025e-06            |  1                    |  3.025e-06          |  1.7018e-06            |
    |  [LightningModule]EfficientFSModule.configure_callbacks                                                                                                                                               |  2.435e-06            |  1                    |  2.435e-06          |  1.3699e-06            |
    |  [Callback]ModelSummary.on_train_end                                                                                                                                                                  |  2.184e-06            |  1                    |  2.184e-06          |  1.2287e-06            |
    |  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                         |  2.184e-06            |  1                    |  2.184e-06          |  1.2287e-06            |
    |  [Callback]ModelSummary.on_train_start                                                                                                                                                                |  2.184e-06            |  1                    |  2.184e-06          |  1.2287e-06            |
    |  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                 |  2.034e-06            |  1                    |  2.034e-06          |  1.1443e-06            |
    |  [LightningModule]EfficientFSModule.prepare_data                                                                                                                                                      |  1.953e-06            |  1                    |  1.953e-06          |  1.0987e-06            |
    |  [LightningModule]EfficientFSModule.setup                                                                                                                                                             |  1.833e-06            |  1                    |  1.833e-06          |  1.0312e-06            |
    |  [Callback]ModelSummary.setup                                                                                                                                                                         |  1.673e-06            |  1                    |  1.673e-06          |  9.4118e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_start               |  1.663e-06            |  1                    |  1.663e-06          |  9.3556e-07            |
    |  [LightningModule]EfficientFSModule.configure_sharded_model                                                                                                                                           |  1.643e-06            |  1                    |  1.643e-06          |  9.243e-07             |
    |  [Callback]TQDMProgressBar.teardown                                                                                                                                                                   |  1.543e-06            |  1                    |  1.543e-06          |  8.6805e-07            |
    |  [LightningModule]EfficientFSModule.on_fit_start                                                                                                                                                      |  1.312e-06            |  1                    |  1.312e-06          |  7.3809e-07            |
    |  [LightningDataModule]LJSpeechDataModule.teardown                                                                                                                                                     |  1.293e-06            |  1                    |  1.293e-06          |  7.274e-07             |
    |  [LightningModule]EfficientFSModule.on_train_end                                                                                                                                                      |  1.292e-06            |  1                    |  1.292e-06          |  7.2684e-07            |
    |  [Strategy]DDPStrategy.on_train_start                                                                                                                                                                 |  1.273e-06            |  1                    |  1.273e-06          |  7.1615e-07            |
    |  [LightningModule]EfficientFSModule.on_fit_end                                                                                                                                                        |  1.232e-06            |  1                    |  1.232e-06          |  6.9309e-07            |
    |  [Strategy]DDPStrategy.on_train_end                                                                                                                                                                   |  1.163e-06            |  1                    |  1.163e-06          |  6.5427e-07            |
    |  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                        |  9.51e-07             |  1                    |  9.51e-07           |  5.35e-07              |
    |  [LightningModule]EfficientFSModule.on_train_start                                                                                                                                                    |  9.12e-07             |  1                    |  9.12e-07           |  5.1306e-07            |
    |  [Callback]ModelSummary.on_fit_end                                                                                                                                                                    |  9.12e-07             |  1                    |  9.12e-07           |  5.1306e-07            |
    |  [Callback]ModelSummary.teardown                                                                                                                                                                      |  9.11e-07             |  1                    |  9.11e-07           |  5.125e-07             |
    |  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                           |  9.01e-07             |  1                    |  9.01e-07           |  5.0688e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_start                 |  8.82e-07             |  1                    |  8.82e-07           |  4.9619e-07            |
    |  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                               |  8.82e-07             |  1                    |  8.82e-07           |  4.9619e-07            |
    |  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                     |  8.02e-07             |  1                    |  8.02e-07           |  4.5118e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.teardown                     |  8.01e-07             |  1                    |  8.01e-07           |  4.5062e-07            |
    |  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                 |  7.62e-07             |  1                    |  7.62e-07           |  4.2868e-07            |
    |  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                        |  7.52e-07             |  1                    |  7.52e-07           |  4.2305e-07            |
    |  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                   |  7.52e-07             |  1                    |  7.52e-07           |  4.2305e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_fit_end                   |  7.51e-07             |  1                    |  7.51e-07           |  4.2249e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_start        |  7.41e-07             |  1                    |  7.41e-07           |  4.1687e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_sanity_check_end          |  7.22e-07             |  1                    |  7.22e-07           |  4.0618e-07            |
    |  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                          |  7.01e-07             |  1                    |  7.01e-07           |  3.9436e-07            |
    |  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': False}.on_train_end                 |  6.91e-07             |  1                    |  6.91e-07           |  3.8874e-07            |
    |  [LightningModule]EfficientFSModule.teardown                                                                                                                                                          |  5.21e-07             |  1                    |  5.21e-07           |  2.931e-07             |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------